var p=!0,u=null;
(function(m,g,i){function o(){var a,b,c;for(a in j){b=f.store("__event."+a);for(c=j[a].length;c--;)j[a][c](b)}n=0}function r(){n||(n=1,clearTimeout(t),t=setTimeout(o,10))}function h(){}function k(){}var g=navigator.userAgent.toLowerCase(),e={scope:"OS"},s={},j={},t,n;h.ext=function(a){function b(){}var c;k.prototype=this.fn;b.prototype=b.fn=new k;b.ext=h.ext;b.methods=h.methods;for(c in a)b.fn[c]=a[c];return b};h.methods=function(a){for(var b in a)this.fn[b]=a[b];return this};h.prototype=h.fn={ALLOWED:0,
NOT_ALLOWED:1,DENIED:2,a:{},_check:function(){return this.i},_request:function(a){a()},_ext:function(a){for(var b in this.a)a[b]===i&&(a[b]=this.a[b]);return a},opt:function(a,b){var c=this;if(b!==i)c.a[a]=b;else if("object"==typeof a)for(b in a)c.a[b]=a[b];else c=c.a[a];return c},access:function(a){if(a){if(!a.c){var b=this;a.c=function(){a.call(b)}}this.hasRight()?a.c():this._request(a.c)}else return this._check()},hasRight:function(){return this.access()==this.ALLOWED},add:k,remove:k,say:function(){return this.add.apply(this,
arguments)},unsay:function(){return this.remove.apply(this,arguments)},bubble:function(){}};var f={API:h,opt:function(a,b){if(b===i)return e[a];e[a]=b;return f},on:function(a,b){j[a]||(j[a]=[]);j[a].push(b);return f},off:function(a,b){if(a in j)for(var c=j[a],d=c.length;d--;)if(c[d]===b){c.splice(d,1);break}return f},emit:function(a,b){f.store("__event."+a,b);r()},scope:function(a,b){var c=f;if(a==i)c=f.scope(e.scope);else if(b!==i)s[a]=b;else if(a in s)c=s[a];else throw'Jinn: scope "'+a+'" is undefined';
return c},e:function(a,b,c){if(a){var d=a.addEventListener?"":"on";a[d?"attachEvent":"addEventListener"](d+b,c,!1)}return f}},l="bubble,access,add,remove,say,unsay".split(","),q=l.length;for(;q--;)(function(a){f[a]=function(){var b=f.scope();return b[a].apply(b,arguments)}})(l[q]);f.store=function(a,b){var c=f,d=f.scope("__store");b===u?d.remove("__jinn."+a):b===i?c=d.get("__jinn."+a):d.set("__jinn."+a,b);return c};(function(a,b){f.scope("__store",{get:function(c){return a?a.getItem(c):b[c]},set:function(c,
d){a?a.setItem(c,d):b[c]=d},remove:function(c){delete b[c];a&&a.removeItem(c)}})})(m.localStorage,{});f[(g.match(/webkit/i)||g.match(/opera/i)||g.match(/msie/i)||0>g.indexOf("compatible")&&g.match(/mozilla/i)||[])[0]]=p;f.h&&(f[(g.match(/chrome/i)||g.match(/safari/i)||[])[0]]=p);f.e(m,"storage",r);m.Jinn=f})(window,document);
(function(m,g,i){function o(){var a,b,c;for(a in j){b=f.store("__event."+a);for(c=j[a].length;c--;)j[a][c](b)}n=0}function r(){n||(n=1,clearTimeout(t),t=setTimeout(o,10))}function h(){}function k(){}var g=navigator.userAgent.toLowerCase(),e={scope:"OS"},s={},j={},t,n;h.ext=function(a){function b(){}var c;k.prototype=this.fn;b.prototype=b.fn=new k;b.ext=h.ext;b.methods=h.methods;for(c in a)b.fn[c]=a[c];return b};h.methods=function(a){for(var b in a)this.fn[b]=a[b];return this};h.prototype=h.fn={ALLOWED:0,
NOT_ALLOWED:1,DENIED:2,a:{},_check:function(){return this.i},_request:function(a){a()},_ext:function(a){for(var b in this.a)a[b]===i&&(a[b]=this.a[b]);return a},opt:function(a,b){var c=this;if(b!==i)c.a[a]=b;else if("object"==typeof a)for(b in a)c.a[b]=a[b];else c=c.a[a];return c},access:function(a){if(a){if(!a.c){var b=this;a.c=function(){a.call(b)}}this.hasRight()?a.c():this._request(a.c)}else return this._check()},hasRight:function(){return this.access()==this.ALLOWED},add:k,remove:k,say:function(){return this.add.apply(this,
arguments)},unsay:function(){return this.remove.apply(this,arguments)},bubble:function(){}};var f={API:h,opt:function(a,b){if(b===i)return e[a];e[a]=b;return f},on:function(a,b){j[a]||(j[a]=[]);j[a].push(b);return f},off:function(a,b){if(a in j)for(var c=j[a],d=c.length;d--;)if(c[d]===b){c.splice(d,1);break}return f},emit:function(a,b){f.store("__event."+a,b);r()},scope:function(a,b){var c=f;if(a==i)c=f.scope(e.scope);else if(b!==i)s[a]=b;else if(a in s)c=s[a];else throw'Jinn: scope "'+a+'" is undefined';
return c},e:function(a,b,c){if(a){var d=a.addEventListener?"":"on";a[d?"attachEvent":"addEventListener"](d+b,c,!1)}return f}},l="bubble,access,add,remove,say,unsay".split(","),q=l.length;for(;q--;)(function(a){f[a]=function(){var b=f.scope();return b[a].apply(b,arguments)}})(l[q]);f.store=function(a,b){var c=f,d=f.scope("__store");b===u?d.remove("__jinn."+a):b===i?c=d.get("__jinn."+a):d.set("__jinn."+a,b);return c};(function(a,b){f.scope("__store",{get:function(c){return a?a.getItem(c):b[c]},set:function(c,
d){a?a.setItem(c,d):b[c]=d},remove:function(c){delete b[c];a&&a.removeItem(c)}})})(m.localStorage,{});f[(g.match(/webkit/i)||g.match(/opera/i)||g.match(/msie/i)||0>g.indexOf("compatible")&&g.match(/mozilla/i)||[])[0]]=p;f.h&&(f[(g.match(/chrome/i)||g.match(/safari/i)||[])[0]]=p);f.e(m,"storage",r);m.Jinn=f})(window,document);
(function(m,g,i,o){m=i.API.ext({_tpl:"#JinnOSTpl",tpl:function(e){this._tpl=e;return this},add:function(e){this._ext(e);this.access(function(){var g=this._create(e);g.show();e.delay&&setTimeout(function(){g.cancel()},1E3*e.delay);return g})}});if(o)m.methods({_check:function(){return o.checkPermission()},_request:function(e){o.requestPermission(e)},_create:function(e){return o.createNotification(e.icon,e.title,e.text)}});else{var r=/\{\{(.*?)\}\}/g,h=[],k=function(e,h){this.b=g.createElement("div");
this.b.innerHTML=("#"==e.charAt(0)?g.getElementById(e.substr(1)).innerHTML:e).replace(r,function(e,g){return(new Function("notify","try{return "+g+'}catch(e){return""}'))(h)});g.body.appendChild(this.b)};k.g=function(){for(var e=5,g=0,i=h.length;g<i;g++)h[g].b.style.top=e+"px",e+=h[g].b.offsetHeight+5};k.prototype={show:function(){if(this.b){h.push(this);var e=this.b.style;e.right="5px";e.position="fixed";e.display="block";k.g()}},cancel:function(){if(this.b){for(var e=0,g=h.length;e<g;e++)h[e]===
this&&(h.splice(e,1),k.g());this.b.parentNode.removeChild(this.b);this.b=u}}};m.methods({_create:function(e){return new k(this._tpl,e)}})}i.scope("OS",new (i.OS=m))})(window,document,Jinn,window.webkitNotifications);
(function(m,g,i,o){function r(v){if(c&&(l.src!=a.src||f!=v))if(d.d(),b.width=b.height=16,l.src=a.src,l.onload=function(){function c(){var d=b.getContext("2d");d.clearRect(0,0,16,16);d.drawImage(l,0,0,l.width,l.height,a.l,a.m,a.k,a.j);a.shape(d,v,q,a);h(b.toDataURL());a.f<=++q&&(q=0)}clearInterval(t);v===u||!a.f?q=0:t=setInterval(c,~~(1E3/a.f+0.5));v===u||v===o?h(a.src):c()},j.test(l.src)?(l.crossOrigin=u,l.removeAttribute("crossOrigin")):l.crossOrigin="anonymous",l.width)l.onload()}function h(a){d.d();
k(function(a){a.parentNode.removeChild(a)});var b=g.createElement("link");b.rel="icon";b.type="image/png";b.href=a;g.getElementsByTagName("head")[0].appendChild(b)}function k(a){for(var b=g.getElementsByTagName("link"),c=b.length;c--;)if(s.test(b[c].getAttribute("rel"))&&a(b[c])===p)return b[c]}function e(){}var s=/\bicon\b/,j=/^data/,t,n,f=u,l=new Image,q=0,a={o:f,f:2,l:0,m:0,k:13,j:13},b=g.createElement("canvas"),c=b.getContext&&!!~b.toDataURL("image/png").indexOf("data:image/png");a.shape=function(a,
b,c){var d=15.5,b=99<b?(d+=0.5,"99+"):b;a.font=(i.h?"bold ":"")+"9px arial";a.shadowOffsetX=0;a.shadowOffsetY=0;a.shadowBlur=2;a.shadowColor="rgba(0,0,0,.5)";a.fillStyle=c?"#fc3":"#fff";a.textAlign="right";a.fillText(b,d,15);a.fillText(b,d,15);a.fillText(b,d,15)};var d={d:function(){d.d=e;d.n=1;var b=k(function(){return p});b&&(n=b.href,d.opt("src",a.src||n))},src:function(a){return d.opt("src",a)},shape:function(a){d.opt("shape",a);return this},opt:function(b,c){var e=d.n||a.val||"shape"==b;if("string"==
typeof b){if(c===o)return a[b];a[b]=c}else for(var g in b)a[g]=b[g],e=e||"shape"==g;c=a.val;e&&r(c);c!==f&&i.emit("bubble:val",c);f=c},set:function(a){d.d();d.opt("val",a)},revert:function(){d.opt("src",n)},reset:function(){d.opt({src:n,val:u})},clear:function(){d.opt("val",u)}};i.OS.Bubble=d;i.scope("OS").bubble=function(a,b){if("object"==typeof a&&a!==u)d.opt(a);else if(a in d)d[a](b);else d.set(a);return this};i.on("bubble:val",function(a){d.set(a)})})(window,document,Jinn);
